<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>mworks API documentation</title>
<meta name="description" content="MWorks with Modular Object-Oriented Games …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>mworks</code></h1>
</header>
<section id="section-intro">
<h1 id="mworks-with-modular-object-oriented-games">MWorks with Modular Object-Oriented Games</h1>
<h2 id="summary">Summary</h2>
<p>This directory contains an example of how to run MOOG with an
<a href="https://mworks.github.io/">Mworks</a> interface. MWorks is a platform for
psychology and neurophysiology tasks.</p>
<p>While MWorks lacks flexibility for interactive physics-based tasks, it provides
precise stimulus timing control and interfaces with eye-trackers,
electrophysiology software, and a variety of controllers. Running MOOG
under-the-hood from MWorks as the example in this directory does combines the
best of both worlds. Furthermore, by implementing your task in MOOG you can run
python-based RL agents on the same task as your experimental subjects without
having to mainting two implementations.</p>
<h2 id="getting-started">Getting Started</h2>
<p>This directory only serves as an example of how to run MOOG from MWorks.</p>
<p>To run this example, follow these steps:</p>
<ol>
<li>Install MWorks. Currently (as of 02/07/2021), you need the "bleeding edge"
nightly build of MWorks, which you can install by downloading the "Nighly
Build" on the <a href="https://mworks.github.io/downloads/">MWorks downloads page</a>. </li>
<li>Create a virtual environment with python version 3.8. If you are using conda,
this can be done with <code>conda create -n your_env_name python=3.8</code></li>
<li>Activate your newly created virtual environment and install MOOG. See
"Getting Started" in the <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/../README.md">main README</a>.</li>
<li>Copy this directory onto your computer. You can use <code>git clone</code> and remove
the other directories or copy the files in this directory manually (there are
only a few files).</li>
<li>To check that the python task runs, run <code>$ python3 run_demo.py</code> and make sure
that the pong task begins playing.</li>
<li>In <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/task.py"><code>task.py</code></a>, edit <code>PWD</code> to reflect the current working directory
and edit <code>_PYTHON_SITE_PACKAGES</code> to reflect the path to your new virtual
environment's python site-packages.</li>
<li>Launch the MWorks Server application (MWServer) and the MWorks Client
application (MWClient). In the client, connect to the server by clicking the
red cross and pressing "connect". This should result in a green checkmark &mdash;
if it doesn't, check that the listening port and listening address in the
MWorks server match the URL and port in the client connection.</li>
<li>Load the <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/main.mwel">main.mwel</a> experiment by clicking on the experiment
folder in the MWorks client and choosing that file for a new experiment.</li>
<li>In the MWorks client, select the "pong" experiment and press the green play
button. You should then be able to play the pong task with the arrow keys on
your keyboard.</li>
<li>You can also select the "pacman" task instead of pong to play that one.
However, to play pacman you must first include <code>'interfaces/keyboard_grid'</code>
in <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/main.mwel">main.mwel</a> instead of <code>'interfaces/keyboard_joystick'</code> (see
the commented lines near the top of <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/main.mwel">main.mwel</a>).</li>
</ol>
<p>If you have a gamepad (e.g. a PS3 controller), you can also plug that into your
computer's USB port and use it's rocker. Just be sure to includer the
appropriate controller interface at the top of <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/main.mwel">main.mwel</a>, namely
<code>'interfaces/gamepad_joystick'</code> for pong or <code>'interfaces/gamepad_grid'</code> for
pacman.</p>
<h2 id="running-your-tasks">Running Your Tasks</h2>
<p>To run your own tasks, begin by implementing your own task configs in MOOG. We
recommend also testing your task configs in python (by running
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/run_demo.py"><code>run_demo.py</code></a> on them) before trying them in MWorks, because
MWorks does not support the <a href="https://docs.python.org/3/library/pdb.html">python
debugger</a> and does not display print
statements from python.</p>
<p>Once your task config is implemented, add a protocol for it at the bottom of
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/main.mwel">main.mwel</a>. Then you should be able to run it from MWorks.</p>
<p>If your task uses an action space other than <code>moog.action_spaces.Joystick</code> or
<code>moog.action_spaces.Grid</code>, then you will have to modify <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/task.py"><code>task.py</code></a> to
handle the new kind of action space.</p>
<h2 id="tips-tricks-and-troubleshooting">Tips, Tricks, and Troubleshooting</h2>
<p>MWorks interfaces:</p>
<ul>
<li>If MWorks does not recognize your keyboard, you might have to change the
<code>preferred_location_id</code> in the <code>keyboard_device</code> in
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/interfaces/keyboard_joystick.mwel"><code>keyboard_joystick.mwel</code></a>. On a mac you
can look up your keyboard's location ID in "About This Mac" &ndash;&gt; "System
Report" &ndash;&gt; "USB". If you are using a bluetooth keyboard, this might not work
and you should switch to a USB keyboard or a gamepad.</li>
<li>If MWorks does not recognize your gamepad, you can similarly look up the
gamepad's location ID and use that in
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/interfaces/gamepad_joystick.mwel"><code>gamepad_joystick.mwel</code></a> or
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/interfaces/gamepad_grid.mwel"><code>gamepad_grid.mwel</code></a>.</li>
<li>If you'd like to use different keys on your keyboard or gamepad, you can find
their usage numbers by setting <code>log_all_input_values = True</code> in the device
interface script, playing the game, pressing the keys you'd like to use, and
looking at the outputs in the MWorks console.</li>
<li>If you'd like to use other types of interfaces (e.g. joystick, eye tracker,
etc.), please refer to the MWorks documentation and write your own interface
files.</li>
</ul>
<p>Debugging:</p>
<ul>
<li>MWorks does not pipe print statements in python to its console and does not
support the python debugger. This can make debugging your python code from
MWorks difficult. For this reason, we recommend testing your task configs with
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/run_demo.py"><code>run_demo.py</code></a> as much as possible.</li>
<li>If you are encountering a python bug when running MWorks (e.g. a bug coming
from <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/task.py"><code>task.py</code></a>), we recommend creating a local dump file in the
python code and writing to that as a surrogate for print statements.</li>
<li>Also note that MWorks has <code>report</code> statements that can be useful for debugging
in MWorks.</li>
</ul>
<h2 id="recording-environment-and-behavior-data">Recording Environment and Behavior Data</h2>
<p>MWorks records event logs. These will contain events for all variable changes in
the MWorks script. See the <a href="https://mworks.github.io/documentation/latest/guide/data_analysis">MWorks data analysis
documentation</a>
for more details.</p>
<p>However, the MWorks logs will not record the display images themselves nor the
state of MOOG. To record the state of MOOG, the MOOG environment in [<code>task.py</code>]
uses a <a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/../moog/env_wrappers/logger.py"><code>LoggerEnvironment</code> wrapper</a>, which logs
the state of the MOOG environment at every timestep. See
<a href="https://github.com/jazlab/moog.github.io/blob/master/./mworks/../moog_demos/restore_logged_data.py"><code>restore_logged_data.py</code></a> for and example
of how to read those logs. However, the <code>LoggerEnvironment</code> wrapper logs all
possible data from the MOOG environment, which can make the log files rather
large, so we recommend you write a custom logger wrapper that only logs the
state data you need for your task.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;.. include:: README.md&#34;&#34;&#34;</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="mworks.configs" href="configs/index.html">mworks.configs</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt><code class="name"><a title="mworks.run_demo" href="run_demo.html">mworks.run_demo</a></code></dt>
<dd>
<div class="desc"><p>Run demo …</p></div>
</dd>
<dt><code class="name"><a title="mworks.task" href="task.html">mworks.task</a></code></dt>
<dd>
<div class="desc"><p>Python task script for interfacing with MWorks …</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#mworks-with-modular-object-oriented-games">MWorks with Modular Object-Oriented Games</a><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#running-your-tasks">Running Your Tasks</a></li>
<li><a href="#tips-tricks-and-troubleshooting">Tips, Tricks, and Troubleshooting</a></li>
<li><a href="#recording-environment-and-behavior-data">Recording Environment and Behavior Data</a></li>
</ul>
</li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="Homepage" href="../index.html">Homepage</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="mworks.configs" href="configs/index.html">mworks.configs</a></code></li>
<li><code><a title="mworks.run_demo" href="run_demo.html">mworks.run_demo</a></code></li>
<li><code><a title="mworks.task" href="task.html">mworks.task</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>
